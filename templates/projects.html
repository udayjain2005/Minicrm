{% extends 'base.html' %}
{% block content %}
<div class="list-header">
    <h1>Projects</h1>
    <form method="get" class="filter-form">
        <input type="text" name="name_filter" placeholder="Project Name" value="{{ name_filter }}">
        <input type="text" name="sector_filter" placeholder="Sector" value="{{ sector_filter }}">
        <input type="text" name="org_filter" placeholder="Organization" value="{{ org_filter }}">
        <button type="submit" class="btn btn-primary">Filter</button>
        <a href="{{ url_for('add_project') }}" class="btn btn-primary">Add Project</a>
        <a href="{{ url_for('bulk_upload_projects') }}" class="btn btn-secondary">Bulk Upload</a>
        <a href="{{ url_for('export_projects') }}" class="btn btn-secondary">Export to Excel</a>
    </form>
</div>
<div class="org-list-container">
    <table class="org-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Sector</th>
                <th>Organization</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for project in projects %}
            <tr class="org-row">
                <td><a href="{{ url_for('edit_project', project_id=project.id) }}">{{ project.name }}</a></td>
                <td>{{ project.sector }}</td>
                <td>{{ project.organization.name if project.organization else '' }}</td>
                <td>{{ project.created_at.strftime('%Y-%m-%d') }}</td>
                <td>
                    <a href="{{ url_for('edit_project', project_id=project.id) }}" class="btn-link">Edit</a>
                    <form action="{{ url_for('delete_project', project_id=project.id) }}" method="post" style="display:inline;">
                        <button type="submit" class="btn-link delete-btn" title="Delete Project">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
                        </button>
                    </form>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% if pages > 1 %}
    <div class="pagination">
        {% for p in range(1, pages+1) %}
            {% if p == page %}
                <span class="page current">{{ p }}</span>
            {% else %}
                <a href="?name_filter={{ name_filter }}&sector_filter={{ sector_filter }}&org_filter={{ org_filter }}&page={{ p }}" class="page">{{ p }}</a>
            {% endif %}
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endblock %}
